debug = require('debug')("layout")

### @ngInject ###
module.exports = ($scope, GroupsStore, AuthService, AUTH_EVENTS, groups) ->
  $scope.groups = groups

  $scope.$on AUTH_EVENTS.loginSuccess, ->
    debug("login success, fetching groups")
    user = AuthService.getCurrentUser()
    GroupsStore.all(memberId: user.id).then (groups) ->
      $scope.groups = groups

  $scope.$on AUTH_EVENTS.logoutSuccess, ->
    debug("logout success, clearing groups")
    $scope.groups = []
