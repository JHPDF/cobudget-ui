module.exports = ($scope, FixedCostModel, FixedCostsStore, AuthService, round, fixedCosts) ->
  round.fixedCosts = fixedCosts
  $scope.round = round
  $scope.user = AuthService.getCurrentUser()

  console.log(round)

  $scope.addFixedCost = ->
    $scope.inserted = {
      name: "name"
      description: "description"
      amount_dollars: 0
    }
    round.fixedCosts.push($scope.inserted)

  $scope.saveFixedCost = (data, id, index) ->
    data.id = id
    data.round_id = round.id

    fixedCost = new FixedCostModel(data)

    console.log("saving", fixedCost.serialize(), id, index)

    fixedCost.save(FixedCostsStore).then ->
      round.fixedCosts[index] = fixedCost.serialize()

  $scope.removeFixedCost = (index) ->
    fixedCost = $scope.round.fixedCosts.splice(index, 1)

    console.log("removing", fixedCost)

    # TODO

  $scope.$watch 'round.fixedCosts', ->
    round.getFixedCostCents()
  , true
