<div class="bucket-page" ng-if="authorized">
  <bucket-page-toolbar></bucket-page-toolbar>

  <md-content class="bucket-page__content">
    <bucket-page-header-card></bucket-page-header-card>
    <bucket-page-progress-card ng-if="bucket.status == 'live'"></bucket-page-progress-card>

    <md-card class="bucket-page__status-card">
      <md-card-content class="bucket-page__status-card-content">
        <div class="bucket-page__status-header">Status</div>
        <div class="bucket-page__status-flagpoints" layout="row" layout-align="space-between center">
          <div class="bucket-page__status-flagpoint">
           
            <div layout="column" layout-align="center center" ng-show="bucket.status == 'draft'">
              <ng-md-icon icon="radio_button_on"
                layout="column"
                layout-align="center center"
                class="bucket-page__draft-icon"
              ></ng-md-icon>
              <span class="bucket-page__status-flagpoint-text-active">Idea</span>
            </div>

            <div layout="column" layout-align="center center" ng-hide="bucket.status == 'draft'">
              <ng-md-icon icon="radio_button_off"
                layout="column"
                layout-align="center center"
                class="bucket-page__status-icon-inactive"
              ></ng-md-icon>
              <span class="bucket-page__status-flagpoint-text-inactive">Idea</span>
            </div>
          </div>

          <div class="bucket-page__status-flagpoint-divider" flex></div>

          <div class="bucket-page__status-flagpoint">
            <div layout="column" layout-align="center center" ng-show="bucket.status == 'live'">
              <ng-md-icon icon="radio_button_on"
                layout="column"
                layout-align="center center"
                class="bucket-page__live-icon"
              ></ng-md-icon>
              <span class="bucket-page__status-flagpoint-text-active">Funding</span>
            </div>

            <div layout="column" layout-align="center center" ng-hide="bucket.status == 'live'">
              <ng-md-icon icon="radio_button_off"
                layout="column"
                layout-align="center center"
                class="bucket-page__status-icon-inactive"
              ></ng-md-icon>
              <span class="bucket-page__status-flagpoint-text-inactive">Funding</span>
            </div>
          </div>

          <div class="bucket-page__status-flagpoint-divider" flex></div>

          <div class="bucket-page__status-flagpoint">
            <div layout="column" layout-align="center center" ng-show="bucket.status == 'funded'">
              <ng-md-icon icon="radio_button_on"
                layout="column"
                layout-align="center center"
                class="bucket-page__funded-icon"
              ></ng-md-icon>
              <span class="bucket-page__status-flagpoint-text-active">Funded</span>
            </div>

            <div layout="column" layout-align="center center" ng-hide="bucket.status == 'funded'">
              <ng-md-icon icon="radio_button_off"
                layout="column"
                layout-align="center center"
                class="bucket-page__status-icon-inactive"
              ></ng-md-icon>
              <span class="bucket-page__status-flagpoint-text-inactive">Funded</span>
            </div>
          </div>

          <div class="bucket-page__status-flagpoint-divider" flex></div>

          <div class="bucket-page__status-flagpoint">
            <div layout="column" layout-align="center center" ng-show="bucket.status == 'done'">
              <ng-md-icon icon="radio_button_on"
                layout="column"
                layout-align="center center"
                class="bucket-page__done-icon"
              ></ng-md-icon>
              <span class="bucket-page__status-flagpoint-text-active">Done</span>
            </div>

            <div layout="column" layout-align="center center" ng-hide="bucket.status == 'done'">
              <ng-md-icon icon="radio_button_off"
                layout="column"
                layout-align="center center"
                class="bucket-page__status-icon-inactive"
              ></ng-md-icon>
              <span class="bucket-page__status-flagpoint-text-inactive">Done</span>

            </div>
          </div>
        </div>

        <div class="bucket-page__status-description" ng-show="bucket.status == 'draft'">
          <p><em>This bucket idea is still being discussed and designed</em></p>

          <div ng-show='userCanStartFunding()'>
            <p><em>As an administrator or creator, you can approve this bucket for funding when it is ready</em></p>
            <md-button class="md-raised md-primary" ng-click='openForFunding()'>Start Funding</md-button>
          </div>
        </div>

        <div class="bucket-page__status-description" ng-show="bucket.status == 'live'">
          <p><em>This bucket has been launched and can be funded.</em></p>
        </div>
      </md-card-content>
    </md-card>

    <md-card class="bucket-page__activity-card">
      <md-card-content class="bucket-page__activity-card-content">
        <div class="bucket-page__activity-header" layout="row">
          <span>
            <div layout="column" layout-align="center center">
              Activity
            </div>
          </span>
          <span flex></span>
          <span>
            <ng-md-icon icon="messenger"
              layout="column"
              layout-align="center center"
              ng-class="bucket.hasComments() ? 'bucket-page__comment-icon-active' : 'bucket-page__comment-icon-inactive'"

            ></ng-md-icon>
            <div class="bucket-page__comment-count" ng-if="bucket.hasComments()">{{ bucket.comments().length }}</div>
          </span>
        </div>

        <form name='commentForm' class="bucket-page__comment-form" ng-submit="createComment()">
          <md-input-container>
            <label>Add a comment</label>
            <input name="body" type="text" ng-model="newComment.body">
          </md-input-container>

          <md-input-container class="cob-hidden-submit-button">
            <input type="submit" aria-label="submit">
          </md-input-container>
        </form>
      </md-card-content>

      <md-list>
        <md-list-item class="bucket-page__comment" ng-repeat="comment in bucket.comments()" layout="column" layout-align="center start">
          <md-divider></md-divider>
          <div class="bucket-page__comment-author-name">{{ comment.author().name }}</div>
          <div class="bucket-page__comment-body" ng-bind-html="comment.body | linky:'_blank'"></div>
        </md-list-item>
      </md-list>
    </md-card>
  </md-content>
</div>